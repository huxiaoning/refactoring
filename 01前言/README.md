# 前言

<br>

从前，有位咨询顾问造访客户调研其开发项目。

系统核心是个类继承体系，顾问看了开发人员所写的一些代码。

他发现整个体系相当凌乱，上层超类对于系统的运作做了一些假设，下层子类实现这些假设。

但是这些假设并不适合所有子类，导致覆写`(override)`工作非常繁重。

只要在超类做点修改，就可以减少许多覆写工作。

在另一些地方，超类的某些意图并未被良好理解，因此其中某些行为在子类内重复出现。

还有一些地方，好几个子类做相同的事情，其实可以把它们搬到继承体系的上层去做。

<br>

这位顾问于是建议项目经理看看这些代码，把它们整理一下，但是经理并不热衷于此，毕竟程序看上去还可以运行，而且项目面临很大的进度压力。

于是经理说，晚些时候再抽时间做这些整理工作。

<br>

顾问也把他的想法告诉了在这个继承体系上工作的程序员,告诉他们可能发生的事情。

程序员都很敏锐,马上就看出问题的严重性。

他们知道这并不全是他们的错,有时候的确需要借助外力才能发现问题。

程员立刻用了一两天的时间整理好这个继承体系,并删掉了其中一半代码,功能毫发无损。

他们对此十分满意,而且发现在继承体系中加入新的类或使用系统中其他类都更快、更容易了。

<br>

项目经理并不高兴。

进度排得很紧,有许多工作要做。

系统必须在几个月之后发布,而这些程序员却白白耗费了两天时间,干的工作与要交付的多数功能毫无关系。

原先的代码运行起来还算正常,他们的新设计看来有点过于追求完美。

项目要交付给客户的,是可以有效运行的代码,不是用以取悦学究的完美东西。

顾问接下来又建议应该在系统的其他核心部分进行这样的理工作,这会使整个项目停顿一至二个星期。

所有这些工作只是为了让代码看起来更漂亮,并不能给系统添加任何新功能。

<br>

你对这个故事有什么感想?

你认为这个顾问的建议(更进一步整理程序)是对的吗?

你会遵循那句古老的工程谚语吗:“如果它还可以运行,就不要动它。”

<br>

我必须承认自己有某些偏见,因为我就是那个顾问。

六个月之后这个项目宣告失败,很大的原因是代码太复杂,无法调试,也无法获得可被接受的性能。

<br>

后来,项目重新启动,几乎从头开始编写整个系统, `Kent Beck`受邀做了顾问。

他做了几件迥异以往的事,其中最重要的一件就是坚持以持续不断的重构行为来整理代码。

这个项目的成功,以及重构在这个成功项目中扮演的角色,启发了我写这本书,

如此一来我就能够把`Kent`和其他一些人已经学会的“以重构方式改进软件质量”的知识,传播给所有读者。

<br>

