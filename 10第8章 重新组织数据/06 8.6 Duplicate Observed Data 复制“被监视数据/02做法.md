# 做法[^1]

<br>

- 修改展现类，使其成为领域类的`Observer[GoF]`。
  - ⇒如果尚未有领域类，就建立一个。
  - ⇒如果没有“从展现类到领域类”的关联，就将领域类保存于展现类的一个字段中。
- 针对`GUI`类中的领域数据，使用`Self Encapsulate Field (171)`。 
- 编译，测试。
- 在事件处理函数中调用设值函数，直接更新`GUI`组件。
  - ⇒在事件处理函数中放一个设值函数，利用它将`GUI`组件更新为领域数据的当前值。当然这其实没有必要，你只不过是拿它的值设定它自己。但是这样使用设值函数，便是允许其中的任何动作得以于日后被执起来，这是这一步骤的意义所在。
  - ⇒进行这个改变时，对于组件，不要使用取值函数，应该直接取用，因为稍后我们将修改取值函数，使其从领域对象（而非`GUI`组件）取值。设值函数也将做类似修改。
  - ⇒确保测试代码能够触发新添加的事件处理机制。
- 编译，测试。
- 在领域类中定义数据及其相关访问函数。
  - ⇒确保领域类中的设值函数能够触发`Observer`模式的通报机制。
  - ⇒对于被观察的数据，在领域类中使用与展现类所用的相同类型（通常是字符串）来保存。后续重构中你可以自由改变这个数据类型。
- 修改展现类中的访问函数，将它们的操作对象改为领域对象（而非`GUI`组件）。
- 修改`Observer`的`update()`，使其从相应的领域对象中将所需数据复制给`GUI`组件。
- 编译，测试。 

<br>

[^1]: 这个重构手法特别复杂建议搭配范例阅读。 ——译者注

