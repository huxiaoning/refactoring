# 做法

<br>

- 为类型码建立一个类。
  - ⇒这个类需要一个用以记录类型码的字段，其类型应该和类型码相同，并应该有对应的取值函数。此外还应该用一组静态变量保存允许被创建的实例，并以一个静态函数根据原本的类型码返回合适的实例。
- 修改源类实现，让它使用上述新建的类。
  - ⇒维持原先以类型码为基础的函数接口，但改变静态字段，以新建的类产生代码。然后，修改类型码相关函数，让它们也从新建的类中获取类型码。
- 编译，测试。
  - ⇒此时，新建的类可以对类型码进行运行期检查。
- 对于源类中每一个使用类型码的函数，相应建立一个函数，让新函数使用新建的类。
  - ⇒你需要建立“以新类实例为自变量”的函数，用以替换原先“直接以类型码为参数”的函数。你还需要建立一个“返回新类实例”的函数，用以替换原先“直接返回类型码”的函数。建立新函数前，你可以使用`Rename Method (273)`修改原函数名称，明确指出哪些函数仍然使用旧式的类型码，这往往是个明智之举。
- 逐一修改源类用户，让它们使用新接口。
- 每修改一个用户，编译并测试。
  - ⇒你也可能需要一次性修改多个彼此相关的函数，才能保持这些函数之间的一致性，才能顺利地编译、测试。
- 删除使用类型码的旧接口，并删除保存旧类型码的静态变量。
- 编译，测试。

<br>

